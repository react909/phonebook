{% extends 'contacts/base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <div>
   <div>
    <small>Сортировать:</small>
    <a href="?{% if q %}q={{ q }}&{% endif %}sort=name" class="btn btn-sm btn-outline-secondary {% if sort == 'name' %}active{% endif %}">По имени</a>
    <a href="?{% if q %}q={{ q }}&{% endif %}sort=created" class="btn btn-sm btn-outline-secondary {% if sort == 'created' %}active{% endif %}">Новые</a>
</div>
<div><small>Всего: {{ contacts.paginator.count }}</small></div>

<div class="row">
  {% for contact in contacts %}
  <div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
    <div class="card h-100 shadow-sm">
      <div class="card-body d-flex">
        <div class="avatar me-3">{{ contact.name|slice:":1" }}</div>
        <div class="flex-grow-1">
          <h5 class="card-title mb-1">
            <a href="{% url 'contact_detail' contact.pk %}">{{ contact.name }}</a>
          </h5>
          <p class="mb-1 small">
            <a href="tel:{{ contact.phone }}">{{ contact.phone }}</a><br>
            {% if contact.email %}<a href="mailto:{{ contact.email }}">{{ contact.email }}</a>{% endif %}
          </p>
          <div class="mt-2">
            <a class="btn btn-sm btn-outline-primary" href="{% url 'contact_update' contact.pk %}">Ред.</a>
            <form action="{% url 'contact_delete' contact.pk %}" method="post" style="display:inline" onsubmit="return confirmDelete();">
              {% csrf_token %}
              <button class="btn btn-sm btn-outline-danger" type="submit">Удал.</button>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% empty %}
    <p>Контактов нет.</p>
  {% endfor %}
</div>

<!-- pagination -->
<nav aria-label="Page navigation">
  <ul class="pagination">
    {% if contacts.has_previous %}
      <li class="page-item"><a class="page-link" href="?{% if q %}q={{ q }}&{% endif %}{% if sort %}sort={{ sort }}&{% endif %}page={{ contacts.previous_page_number }}">Назад</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Назад</span></li>
    {% endif %}
    <li class="page-item disabled"><span class="page-link">Страница {{ contacts.number }} из {{ contacts.paginator.num_pages }}</span></li>
    {% if contacts.has_next %}
      <li class="page-item"><a class="page-link" href="?{% if q %}q={{ q }}&{% endif %}{% if sort %}sort={{ sort }}&{% endif %}page={{ contacts.next_page_number }}">Вперёд</a></li>
    {% else %}
      <li class="page-item disabled"><span class="page-link">Вперёд</span></li>
    {% endif %}
  </ul>
</nav>
{% endblock %}
